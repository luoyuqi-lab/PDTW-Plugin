import numpy as np
from Functions import txt_loader, cdtw, fill_envelope, LB_Petitjean, LB_New, LB_Keogh, LB_Webb, dist,cdtw, txt_loader, fill_envelope, segment_cont, TS_segmentation
from LB_KP import LB_KP_EA
from LB_NP import LB_NP_EA
from LB_PP import LB_PP_EA
from LB_WP import LB_WP_EA

r_train = [-0.56870868, -0.88811805, -0.047976584, -0.038036109, -0.48306827, -1.0946887, -0.95345287, -0.030006881, -0.79545456,
           -0.51445458, -0.71876142, -0.51627228, -1.0740292, -0.43143528, -0.70491401, 0.081199243, -0.18071334, -0.41380542,
           -1.2541398, 0.62861272, 0.10925689, -0.40352451, 0.29848983, -1.0170097, 0.1060293, -0.32393784, -0.88263273, -0.078209774,
           -0.47673375, 0.30925792, -0.68720484, -0.047918279, 0.043894441, -0.24588905, 1.4838271, 0.47106999, -0.22834216, 0.62188246,
           0.85074754, 0.44598501, 0.67410028, 0.4381375, 1.3025001, 1.5158618, 1.0840099, 0.5290753, 1.0051872, 1.2504343, 1.8793513,
           1.2464359, 0.97652281, 1.0508488, 1.7077134, 0.77998733, 0.808501, 1.9589051, 2.5223094, 1.6504349, 1.9575071, 1.9149208,
           1.9881925, 2.3885283, 2.6563402, 3.2445649, 2.5338502, 2.2126811, -0.50017997, 0.13632626, -0.1441732, 0.10614366, -0.086865892,
           -1.2128345, 0.052023116, 0.28845924, -1.779425, -0.51452533, -0.61662303, -1.0129302, 0.12700365, -0.9401846, -0.57215784, -0.4926672,
           -1.154128, -0.5546875, -1.4167936, -0.72366355, -0.4996501, -0.15871588, -0.021429563, -0.11397757, -1.606342, -0.43054809, -0.054970458,
           -1.4477832, 0.040901319, -1.2090535, -0.66597733, 0.17587064, -1.07419, -1.1357511, -0.85132687, -0.47887339, -1.2767027, 0.019725047, -0.369314,
           -0.82186455, -0.80150441, -0.17233083, -0.60426942, -0.44592446, -0.44231209, 0.0055312883, -0.96598956, -0.078308797, -0.53922905, -0.60782592,
           0.029041713, 0.043836515, -0.99073975, 0.51837462, -0.22856277, -0.56528868, -0.64299796, -1.1094278, -0.10109322, -0.23394901, -0.61982693, -0.083061887]
r_test = [-1.259494, -1.2040014, -0.76855784, -0.74828691, -0.52574498, -1.4947601, -0.87565295, -1.0606748, -1.9882661, -1.0142588, -0.74076965, -0.49965622,
          -0.1904649, -0.92383887, -1.4085461, -0.24978992, -0.81731635, -0.13273624, -1.3745039, -1.1590026, -0.51935665, -0.96073794, -0.50764727, -0.44836798,
          -1.316067, -0.65043713, -0.35722745, -0.38366608, -0.49914206, -0.72304626, -0.051559845, -1.1060279, -0.33059677, -0.21507906, -1.3270948, -0.65057028,
          -0.55810613, -0.55399291, -0.19961935, -0.88361125, -0.40202991, -0.96345084, -0.97009236, -0.36297049, -0.7652242, -0.62225341, -0.16098983, 0.14611224,
          -0.074074532, 0.47708373, -0.27252445, -0.80685026, -0.085698087, 0.29006839, -0.095945301, 0.75868192, 0.018458924, -0.52362321, 0.017097927, 0.14039878,
          0.049767763, 1.3526222, -0.057657045, 0.22281818, 0.67177182, 0.59059689, 1.3783546, 0.30155749, 0.38326124, 1.8859324, 0.87810503, 1.420221, -0.32201005,
          1.192275, 0.62495048, -0.52967564, 0.4609596, 1.4527415, 0.7372664, 1.0309279, 0.44079919, 1.2894037, 0.11483587, 0.85606236, 0.87990224, 0.67628484, 1.0119471,
          1.4326709, 1.7283172, 0.90079677, 2.3835403, 0.96674323, 1.5959026, 1.3119763, 1.9024449, 0.9385378, 1.3070139, 1.7744032, 1.0397952, 0.89856308, 0.81419347,
          1.7292871, 1.6712214, 1.7614136, 1.5022511, 1.499996, 1.483354, 1.3052091, 1.6215237, 1.3540308, -0.90642139, -0.5061344, -0.75494449, -0.14763818, -0.8512427,
          -0.94835666, -1.1238806, -1.1195401, -1.5131705, -0.47698703, -1.243944, -1.041045, -1.3251038, -0.70652092, -0.97836123, -0.81429112, -1.6035022, -0.92002157]
a = np.array(r_train)
b = np.array(r_test)
w, N, p, bsf= 15, 10, 1, 1000

x, y, con = TS_segmentation(a, b, N, w)
print("Segmental contribution ranking:",con)

CDTW_distance = cdtw(a, b, w, False)
print("CDTW distance:", CDTW_distance)

ub, lb = fill_envelope(b, w)
ulb, llb = fill_envelope(lb, w)
uub, lub = fill_envelope(ub, w)
print("lb_keogh:", LB_Keogh(a, b, w, ub, lb, bsf))
print("lb_KP:", LB_KP_EA(a, b, w, ub, lb, N, p, bsf))

print("lb_New:", LB_New(a, b, w, ub, lb, bsf))
print("lb_NP:", LB_NP_EA(a, b, w, ub, lb, N, p, bsf))

print("lb_Petitjean:", LB_Petitjean(a, b, w, ub, lb, bsf))
print("lb_PP:", LB_PP_EA(a, b, w, ub, lb, N, p, bsf))

print("lb_Webb:", LB_Webb(a, b, w, ub, lb, ulb, lub, bsf))
print("lb_WP:", LB_WP_EA(a, b, w, ub, lb, ulb, lub, N, 1, bsf))
